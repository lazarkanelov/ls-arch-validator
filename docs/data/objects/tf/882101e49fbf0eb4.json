{
  "main_tf": "# Serverless E-Commerce Order API\n\nresource \"aws_dynamodb_table\" \"orders\" {\n  name           = \"orders\"\n  billing_mode   = \"PAY_PER_REQUEST\"\n  hash_key       = \"order_id\"\n  range_key      = \"customer_id\"\n\n  attribute {\n    name = \"order_id\"\n    type = \"S\"\n  }\n\n  attribute {\n    name = \"customer_id\"\n    type = \"S\"\n  }\n\n  attribute {\n    name = \"status\"\n    type = \"S\"\n  }\n\n  global_secondary_index {\n    name            = \"customer-orders-index\"\n    hash_key        = \"customer_id\"\n    range_key       = \"order_id\"\n    projection_type = \"ALL\"\n  }\n\n  global_secondary_index {\n    name            = \"status-index\"\n    hash_key        = \"status\"\n    projection_type = \"KEYS_ONLY\"\n  }\n\n  tags = {\n    Environment = var.environment\n  }\n}\n\nresource \"aws_dynamodb_table\" \"inventory\" {\n  name           = \"inventory\"\n  billing_mode   = \"PAY_PER_REQUEST\"\n  hash_key       = \"product_id\"\n\n  attribute {\n    name = \"product_id\"\n    type = \"S\"\n  }\n\n  tags = {\n    Environment = var.environment\n  }\n}\n\nresource \"aws_lambda_function\" \"api\" {\n  function_name = \"order-api-handler\"\n  runtime       = \"python3.11\"\n  handler       = \"handlers.lambda_handler\"\n  role          = aws_iam_role.lambda.arn\n  filename      = \"lambda.zip\"\n  timeout       = 30\n  memory_size   = 256\n\n  environment {\n    variables = {\n      ORDERS_TABLE    = aws_dynamodb_table.orders.name\n      INVENTORY_TABLE = aws_dynamodb_table.inventory.name\n      ENVIRONMENT     = var.environment\n    }\n  }\n}\n\nresource \"aws_api_gateway_rest_api\" \"main\" {\n  name = \"order-api\"\n}\n\nresource \"aws_api_gateway_resource\" \"orders\" {\n  rest_api_id = aws_api_gateway_rest_api.main.id\n  parent_id   = aws_api_gateway_rest_api.main.root_resource_id\n  path_part   = \"orders\"\n}\n",
  "variables_tf": "variable \"environment\" {\n  type        = string\n  description = \"Deployment environment\"\n  default     = \"dev\"\n}\n",
  "outputs_tf": null
}